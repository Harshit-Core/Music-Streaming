<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoundWave - Music Streaming Platform</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-music"></i>
                <h1>SoundWave</h1>
            </div>
        </div>
        
        <nav class="sidebar-nav">
            <ul class="nav-menu">
                <li class="nav-item active">
                    <a href="#" data-section="discover" class="nav-link">
                        <i class="fas fa-compass"></i>
                        <span>Discover</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" data-section="library" class="nav-link">
                        <i class="fas fa-book"></i>
                        <span>Your Library</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" data-section="search" class="nav-link">
                        <i class="fas fa-search"></i>
                        <span>Search</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" data-section="playlists" class="nav-link">
                        <i class="fas fa-list"></i>
                        <span>Playlists</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" data-section="artists" class="nav-link">
                        <i class="fas fa-microphone"></i>
                        <span>Artists</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" data-section="albums" class="nav-link">
                        <i class="fas fa-compact-disc"></i>
                        <span>Albums</span>
                    </a>
                </li>
            </ul>
            
            <div class="playlist-section">
                <h3>Your Playlists</h3>
                <ul class="playlist-list" id="sidebarPlaylists">
                    <li class="playlist-item">
                        <i class="fas fa-music"></i>
                        <span>Liked Songs</span>
                    </li>
                    <li class="playlist-item">
                        <i class="fas fa-plus"></i>
                        <span>Create Playlist</span>
                    </li>
                </ul>
            </div>
            
            <div class="api-section">
                <h3>Connect APIs</h3>
                <div class="api-connections">
                    <button class="api-btn spotify-btn" id="connectSpotify">
                        <i class="fab fa-spotify"></i>
                        <span>Connect Spotify</span>
                    </button>
                    <div class="api-status" id="spotifyStatus">
                        <i class="fas fa-circle"></i>
                        <span>Disconnected</span>
                    </div>
                </div>
            </div>
        </nav>
    </aside>

    <!-- Main Content Area -->
    <main class="main-content">
        <!-- Top Navigation Bar -->
        <header class="top-nav">
            <div class="nav-controls">
                <button class="nav-btn" id="backBtn" disabled>
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="nav-btn" id="forwardBtn" disabled>
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search for songs, artists, albums..." id="globalSearch">
            </div>
            
            <div class="user-profile">
                <button class="nav-btn api-settings-btn" id="apiSettingsBtn" title="API Settings">
                    <i class="fas fa-cog"></i>
                </button>
                <div class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                </div>
                <div class="profile-info">
                    <img src="https://images.unsplash.com/photo-1494790108755-2616c9d4dc96?w=40&h=40&fit=crop&crop=face" alt="Profile" class="profile-img">
                    <span class="profile-name">Music Lover</span>
                </div>
            </div>
        </header>

        <!-- Content Sections -->
        <div class="content-area">
            <!-- Discover Section -->
            <section class="content-section active" id="discover">
                <div class="section-header">
                    <h2>Discover Music</h2>
                    <p>Fresh tunes and trending hits</p>
                </div>
                
                <div class="featured-section">
                    <h3>Featured Playlists</h3>
                    <div class="card-grid" id="featuredPlaylists">
                        <!-- Featured playlists will be loaded here -->
                    </div>
                </div>
                
                <div class="trending-section">
                    <h3>Trending Now</h3>
                    <div class="song-list" id="trendingSongs">
                        <!-- Trending songs will be loaded here -->
                    </div>
                </div>
                
                <div class="genres-section">
                    <h3>Browse by Genre</h3>
                    <div class="genre-grid" id="genreGrid">
                        <!-- Genres will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Search Section -->
            <section class="content-section" id="search">
                <div class="section-header">
                    <h2>Search</h2>
                    <p>Find your favorite music</p>
                </div>
                
                <div class="search-filters">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="songs">Songs</button>
                    <button class="filter-btn" data-filter="artists">Artists</button>
                    <button class="filter-btn" data-filter="albums">Albums</button>
                    <button class="filter-btn" data-filter="playlists">Playlists</button>
                </div>
                
                <div class="search-results" id="searchResults">
                    <div class="search-placeholder">
                        <i class="fas fa-search"></i>
                        <h3>Start searching</h3>
                        <p>Find songs, artists, albums, and playlists</p>
                    </div>
                </div>
            </section>

            <!-- Library Section -->
            <section class="content-section" id="library">
                <div class="section-header">
                    <h2>Your Library</h2>
                    <p>Your saved music and playlists</p>
                </div>
                
                <div class="library-tabs">
                    <button class="tab-btn active" data-tab="songs">Songs</button>
                    <button class="tab-btn" data-tab="artists">Artists</button>
                    <button class="tab-btn" data-tab="albums">Albums</button>
                </div>
                
                <div class="library-content" id="libraryContent">
                    <!-- Library content will be loaded here -->
                </div>
            </section>

            <!-- Playlists Section -->
            <section class="content-section" id="playlists">
                <div class="section-header">
                    <h2>Your Playlists</h2>
                    <button class="create-playlist-btn" id="createPlaylistBtn">
                        <i class="fas fa-plus"></i>
                        Create Playlist
                    </button>
                </div>
                
                <div class="playlist-grid" id="playlistGrid">
                    <!-- User playlists will be loaded here -->
                </div>
            </section>

            <!-- Artists Section -->
            <section class="content-section" id="artists">
                <div class="section-header">
                    <h2>Artists</h2>
                    <p>Discover amazing artists</p>
                </div>
                
                <div class="artist-grid" id="artistGrid">
                    <!-- Artists will be loaded here -->
                </div>
            </section>

            <!-- Albums Section -->
            <section class="content-section" id="albums">
                <div class="section-header">
                    <h2>Albums</h2>
                    <p>Browse through album collections</p>
                </div>
                
                <div class="album-grid" id="albumGrid">
                    <!-- Albums will be loaded here -->
                </div>
            </section>
        </div>
    </main>

    <!-- Music Player -->
    <div class="music-player" id="musicPlayer">
        <div class="player-info">
            <div class="song-artwork">
                <img src="" alt="Song Artwork" id="currentArtwork" class="artwork-img">
                <!-- YouTube Player Container -->
                <div class="youtube-player-container" id="youtubePlayerContainer" style="display: none;">
                    <div id="youtubePlayer" class="youtube-embed"></div>
                </div>
                <div class="equalizer" id="equalizer">
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                </div>
            </div>
            <div class="song-details">
                <h4 class="song-title" id="currentTitle">Select a song</h4>
                <p class="song-artist" id="currentArtist">Artist</p>
            </div>
            <button class="like-btn" id="likeBtn">
                <i class="far fa-heart"></i>
            </button>
        </div>

        <div class="player-controls">
            <div class="control-buttons">
                <button class="control-btn shuffle-btn" id="shuffleBtn">
                    <i class="fas fa-random"></i>
                </button>
                <button class="control-btn" id="prevBtn">
                    <i class="fas fa-step-backward"></i>
                </button>
                <button class="control-btn play-btn" id="playBtn">
                    <i class="fas fa-play"></i>
                </button>
                <button class="control-btn" id="nextBtn">
                    <i class="fas fa-step-forward"></i>
                </button>
                <button class="control-btn repeat-btn" id="repeatBtn">
                    <i class="fas fa-redo"></i>
                </button>
            </div>
            
            <div class="progress-container">
                <span class="time-display" id="currentTime">0:00</span>
                <div class="progress-bar" id="progressBar">
                    <div class="progress-fill" id="progressFill"></div>
                    <div class="progress-handle" id="progressHandle"></div>
                </div>
                <span class="time-display" id="totalTime">0:00</span>
            </div>
        </div>

        <div class="player-extras">
            <button class="extra-btn queue-btn" id="queueBtn">
                <i class="fas fa-list"></i>
            </button>
            <button class="extra-btn lyrics-btn" id="lyricsBtn">
                <i class="fas fa-microphone-alt"></i>
            </button>
            <div class="volume-control">
                <button class="extra-btn volume-btn" id="volumeBtn">
                    <i class="fas fa-volume-up"></i>
                </button>
                <div class="volume-slider" id="volumeSlider">
                    <div class="volume-fill" id="volumeFill"></div>
                    <div class="volume-handle" id="volumeHandle"></div>
                </div>
            </div>
            <button class="extra-btn fullscreen-btn" id="fullscreenBtn">
                <i class="fas fa-expand"></i>
            </button>
        </div>
    </div>

    <!-- Modals -->
    <!-- Create Playlist Modal -->
    <div class="modal" id="createPlaylistModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create New Playlist</h3>
                <button class="modal-close" id="closeCreatePlaylist">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="playlistName">Playlist Name</label>
                    <input type="text" id="playlistName" placeholder="My Awesome Playlist">
                </div>
                <div class="form-group">
                    <label for="playlistDescription">Description (Optional)</label>
                    <textarea id="playlistDescription" placeholder="Add a description..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelCreatePlaylist">Cancel</button>
                <button class="btn btn-primary" id="confirmCreatePlaylist">Create</button>
            </div>
        </div>
    </div>

    <!-- API Settings Modal -->
    <div class="modal" id="apiSettingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>API Configuration</h3>
                <button class="modal-close" id="closeApiSettings">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="api-config-section">
                    <h4><i class="fab fa-spotify"></i> Spotify Web API</h4>
                    <p class="api-description">Connect to Spotify to access millions of songs, playlists, and your personal music library.</p>
                    <div class="form-group">
                        <label for="spotifyClientId">Client ID</label>
                        <input type="text" id="spotifyClientId" placeholder="Your Spotify Client ID">
                        <small>Get this from <a href="https://developer.spotify.com/dashboard" target="_blank">Spotify Developer Dashboard</a></small>
                    </div>
                    <div class="form-group">
                        <label for="spotifyClientSecret">Client Secret</label>
                        <input type="password" id="spotifyClientSecret" placeholder="Your Spotify Client Secret">
                    </div>
                    <button class="btn btn-spotify" id="saveSpotifyConfig">
                        <i class="fab fa-spotify"></i>
                        Save & Connect Spotify
                    </button>
                </div>
                
                <div class="api-config-section">
                    <h4><i class="fab fa-youtube"></i> YouTube Data API</h4>
                    <p class="api-description">Search and discover music videos from YouTube's vast library.</p>
                    <div class="form-group">
                        <label for="youtubeApiKey">API Key</label>
                        <input type="password" id="youtubeApiKey" placeholder="Your YouTube API Key">
                        <small>Get this from <a href="https://console.developers.google.com/" target="_blank">Google Cloud Console</a></small>
                    </div>
                    <button class="btn btn-youtube" id="saveYoutubeConfig">
                        <i class="fab fa-youtube"></i>
                        Save YouTube Config
                    </button>
                </div>
                
                <div class="api-help">
                    <h4>Quick Setup Guide</h4>
                    <details>
                        <summary>How to get Spotify API credentials</summary>
                        <ol>
                            <li>Go to <a href="https://developer.spotify.com/dashboard" target="_blank">Spotify Developer Dashboard</a></li>
                            <li>Log in with your Spotify account</li>
                            <li>Click "Create App"</li>
                            <li>Fill in app name and description</li>
                            <li>Add your website URL as redirect URI (e.g., http://localhost:3000)</li>
                            <li>Copy Client ID and Client Secret</li>
                        </ol>
                    </details>
                    <details>
                        <summary>How to get YouTube API key</summary>
                        <ol>
                            <li>Go to <a href="https://console.developers.google.com/" target="_blank">Google Cloud Console</a></li>
                            <li>Create a new project or select existing</li>
                            <li>Enable YouTube Data API v3</li>
                            <li>Go to Credentials and create API key</li>
                            <li>Restrict the key to YouTube Data API v3</li>
                        </ol>
                    </details>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="testAPIs">ðŸ”§ Test APIs</button>
                <button class="btn btn-secondary" id="testYouTube" onclick="testYouTubePlayer()">ðŸŽµ Test YouTube Player</button>
                <button class="btn btn-secondary" id="cancelApiSettings">Close</button>
            </div>
        </div>
    </div>

    <!-- Queue Panel -->
    <div class="queue-panel" id="queuePanel">
        <div class="queue-header">
            <h3>Play Queue</h3>
            <button class="queue-close" id="closeQueue">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="queue-content">
            <div class="now-playing">
                <h4>Now Playing</h4>
                <div class="queue-song current" id="queueCurrent">
                    <!-- Current song will be displayed here -->
                </div>
            </div>
            <div class="next-up">
                <h4>Next Up</h4>
                <div class="queue-list" id="queueList">
                    <!-- Queue songs will be displayed here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Lyrics Panel -->
    <div class="lyrics-panel" id="lyricsPanel">
        <div class="lyrics-header">
            <h3>Lyrics</h3>
            <button class="lyrics-close" id="closeLyrics">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="lyrics-placeholder">
        <div class="lyrics-content" id="lyricsContent">
                <i class="fas fa-music"></i>
                <p>Lyrics will appear here when available</p>
            </div>
        </div>
    </div>

    <!-- Audio Visualization Canvas -->
    <canvas id="visualizer" class="visualizer"></canvas>

    <!-- Hidden Audio Element -->
    <audio id="audioPlayer" preload="metadata"></audio>

    <!-- YouTube IFrame API -->
    <script src="https://www.youtube.com/iframe_api"></script>

    <script src="data.js"></script>
    <script src="api.js"></script>
    <script src="player.js"></script>
    <script src="app.js"></script>
    
    <script>
        // Debug function
        window.testSearch = function() {
            console.log('=== SEARCH TEST ===');
            console.log('App exists:', typeof app !== 'undefined');
            console.log('MusicAPI exists:', typeof musicAPI !== 'undefined');
            console.log('MusicData exists:', typeof musicData !== 'undefined');
            
            if (typeof app !== 'undefined') {
                console.log('Testing search with "jazz"...');
                app.searchQuery = 'jazz';
                app.performSearch();
            } else {
                console.log('App not ready yet');
            }
        };
        
        // YouTube Player Test Function
        window.testYouTubePlayer = function() {
            console.log('=== YOUTUBE PLAYER TEST ===');
            console.log('Player exists:', typeof player !== 'undefined');
            if (typeof player !== 'undefined') {
                console.log('YouTube player:', !!player.youtubePlayer);
                console.log('YouTube ready:', player.isYouTubePlayerReady);
                console.log('Current player type:', player.currentPlayerType);
                
                // Create a test YouTube song
                const testSong = {
                    id: 'youtube_test_123',
                    title: 'Test YouTube Video',
                    artist: 'Test Artist',
                    source: 'youtube',
                    youtubeId: 'dQw4w9WgXcQ', // Rick Roll for testing
                    artwork: 'https://i.ytimg.com/vi/dQw4w9WgXcQ/default.jpg'
                };
                
                console.log('Testing with song:', testSong);
                player.playSong(testSong);
            } else {
                console.log('Player not ready yet');
            }
        };
        
        // Auto-test when everything is loaded
        setTimeout(() => {
            if (typeof app !== 'undefined' && typeof musicAPI !== 'undefined') {
                console.log('All components loaded successfully!');
                console.log('API Status:', {
                    spotify: musicAPI.isSpotifyConfigured(),
                    youtube: musicAPI.isYouTubeConfigured(),
                    authenticated: musicAPI.isAuthenticated()
                });
                
                // Test YouTube player initialization
                if (typeof player !== 'undefined') {
                    console.log('Player status:', {
                        youtubePlayer: !!player.youtubePlayer,
                        isYouTubePlayerReady: player.isYouTubePlayerReady,
                        currentPlayerType: player.currentPlayerType
                    });
                }
            }
        }, 2000);
    </script>
</body>
</html>
